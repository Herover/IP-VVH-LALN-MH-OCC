(*Gruppe afl uge 2*)


(*Filer vedhæftes til programmet*)
use "uge2_distance.sml";
use "uge2_cphmarathon2014.sml";

(*2G1*)
(*
* Funktionen adderer et elementer og fjerner dem, indtil listen er tom
*)

fun sum [] = raise Empty
 | sum [_] = 0.0
 | sum (x :: xs) = distance(x, List.nth(xs, 0)) + sum xs; 


sum cphMarathon2014 ;
sum cphMarathon2014 - 42.9686446838;

(*2G2*)
(*
 * Hastigheden mellem to punkter i listen en liste over punkter skal udregnes.
 * Ideen er at løbe listen rekursivt gennem men både behandle nuværende punkt og
 * det næste i listen. Derefter sættes den udregnede hastighed forest i en ny
 * liste for at rækkefølgen er korrekt.
 * Modtages en tom liste kaster vi en Empty exception, eftersom det ikke giver
 * logisk mening at måle hastigheden når man bevæger sig fra ingenting til
 * ingenting.
 *)

use "uge2_dhl2014.sml";

(* Værdier med storebæltsbroen kan bruges til at teste med en overskuelig 
 * datamængde.
 *)
(* val test = [((55.702412, 12.568260), 0), ((55.702385, 12.568090), 5858), ((55.702302, 12.567562), 11716)]; *)

fun speeds [] = raise Empty
 | speeds [_] = []
 | speeds (x :: xs) = 
  let val (p1, t1) = x
      val (p2, t2) = List.nth(xs, 0) 
  in [distance(p1, cp2) / (real((t2-t1)) / (1000.0*3600.0))]@speeds xs   
  end; 
  
 speeds dhl2014;
 
 
 
(*2G3*)

fun sum2 [] = 0.0
 | sum2 (x :: xs) = x + sum2 xs; 
fun snit xs = (sum2 xs) /  real (list.length xs);

snit(speeds(dhl2014));


(*2G4*)

fun averageSpeed n = snit(speeds(n));

averageSpeed(dhl2014);


(*2G5*)


 
 
